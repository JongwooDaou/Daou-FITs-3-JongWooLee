# TIL: JAVA
## 학습날짜: 2025년 2월 17일

## Problem:
- web application project 경험은 있으나 framework에 의존했었기에 부족한 WAS, Http protocol 이해 부족

## Solution:
- Tomcat을 활용해 직접 servlet을 구현하고 method를 직접 추적해보며 확인

## What I Learned

### Servlet
- java에서 제공하는 interface HttpServlet
- `init()` : 서블릿 객체가 생성될 때 호출되어 초기화를 당담( 생성자도 호출 되지만 생성자의 역할 수행)
- `service()` : 클라이언트가 서블릿을 실행할 때 호출, 일반적으로 overriding 하지 않음.  
  클라이언트의 요청이 GET 일경우 doGet(), POST 일 경우 doPost() 호출
- `doGet()`,`doPost()` : 두개의 method를 overriding해서 client가 원하는 작업을 수행
- `destroy` : servlet instance가 WAS에서 삭제될 때 수행 -> 사용되고 있는 resource들을 해제
- client가 Servlet을 호출하는 방식
- - 1. `.xml` : 번거롭지만 전체적인 관리를 하나의 파일해서 할 수 있음
    2. `Annotation`을 이용해서 URL 매핑 ( 일반적인 방식 ) 직관적으로 사용할 수 있음
- doGet()
```java
    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        // client 의 요청이 GET 방식일 경우
        // 입력 받기
        // 로직처리
        // 출력처리
        System.out.println("doGet called");

        // 데이터 통로 오픈 전 전달되는 데이터의 형태를 먼저 지정
        resp.setContentType("text/html; charset=UTF-8");

        // client 에게 데이터 통로 오픈(일반적으로 PrintWriter 이용)
        PrintWriter out = resp.getWriter();

        // out 을 통해서 데이터 전송
        out.println("<html>" +
                "<body>");
        out.println("<h1>" + req.getRequestURI() +"입니다." + "</h1>");
        out.println("</body>" +
                "</html>");
        out.flush();
        out.close();

    }
```

### Client - Server 데이터 전달
- 1. GET
- - `Query String`을 이용해서 데이터 전달
  - `?변수=값&변수=값&변수=값` -> `?name=hong&age=20&address=seoul`
  - ```java
    String name = req.getParameter("name");
    String age = req.getParameter("age");
    String address = req.getParameter("address");
    ```
  - 보안성이 없기 때문에 암호화를 이용해서 처리 필요
  - URL에 길이 제한이 있기 때문에 많은 양의 데이터를 보낼 수 없음
- 2. POST
- - GET방식 보다는 보안성이 있음 ( URL에 내용이 포함되지 않지만 암호화 필요 )
  - `request header`에 포함되어 전달되기 때문에 길이 제한 없음
  - HTML의 특수한 태그를 이용해서 서버 Servlet을 호출
  - post요청 html
  - ```html
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Title</title>
    </head>
    <body>
    <h1>서버에 전달할 데이터를 입력하세요</h1>
      <form action="http://localhost:8080/HelloServletProject/myServlet"
            method="post">
        이름 : <input name="name" type="text" >
        <br><br>
        나이 : <input name="age" type="number" >
        <br><br>
        주소 : <input name="address" type="text" >
        <br><br>
        <input type="submit" value="서버로 전송">
      </form>
    
    </body>
    </html>
    ```
  - doPost() java
  - ```java
        @Override
        protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
            // client 의 요청이 POST 방식일 경우
            // 입력 받기
            // 입력을 받을 때 한글과 같은 유니코드 포함되어 있다면
            req.setCharacterEncoding("UTF-8");
            String name = req.getParameter("name");
            String age = req.getParameter("age");
            String address = req.getParameter("address");
            // 로직처리
            // 출력처리
    
    
            resp.setContentType("text/html; charset=UTF-8");
    
            // client 에게 데이터 통로 오픈(일반적으로 PrintWriter 이용)
            PrintWriter out = resp.getWriter();
    
            // out 을 통해서 데이터 전송
            out.println("<html>" +
                    "<body>");
            out.println("<h1>" + "반갑습니다" + name + "</h1>");
            out.println("<p>" + "name: " + name + "<br><br>" +
                    "age: "+age + "<br><br>" +
                    "address: " + address +"</p>");
            out.println("</body>" +
                    "</html>");
            out.flush();
            out.close();
        }
    }
    ```
    
